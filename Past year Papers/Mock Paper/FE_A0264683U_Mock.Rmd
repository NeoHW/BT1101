---
title: "BT1101 Practice Exam"
author: "BT1101 Student. A0264683U"
date: '24 Nov 2022, 9:00 - 11:30AM'
output: html_document
---

## Instructions
- **Rename your R Markdown file `FE_Student#.rmd`**, replacing Student# with your Student number that starts with A (e.g. A0202020) and the output will automatically be `FE_Student#.html`. 
- Select `output: html_document`.
- Include all code chunks, so include `echo=TRUE` in all chunks.
- Replace the placeholder text, "Type your answer here.", with your own.
- Pre-install and include any `library('package_name')` statements before exam starts. Remember that there is NO Internet connection during the exam.

- Code and type your answer in this Rmarkdown file during exam but **keep in mind that you need to copy and paste all your answer (r-chunk and text) into Essay Answer section for each question in Examplify.**
- Submit both R Markdown file (.rmd) and HTML (.html) to the folder "Final Exam Submission" in Luminus after Examplify submission and Internet reconnection.
- This Rmarkdown file serves as a reference. **Only answers submitted in Examplify will be graded.** Zero point will be given for blank submission in Examplify even if you have submitted a complete Rmarkdown/HTML file.

## Preparation

```{r preparation, echo=TRUE, warning = FALSE, message = FALSE}

library('libcoin')
library("rcompanion") #this package is required for transformTukey function
library("rstatix")
library("Rmisc") 
library("dplyr") #need to call the library before you use the package
library("tidyr")
library("rpivotTable")
library("knitr")
library("psych")
library(tidyverse)
library(ggplot2) 
library(TTR)
library(factoextra) # for fviz_cluster()
library(lpSolve)

# predictive/prescriptive analytics
library(tseries) 
library(forecast)
library(lpSolve)
library(TTR)

# descriptive analytics
library(Rmisc)
library(rcompanion)
library(rpivotTable)
library(EnvStats) 
library(car)
library(rstatix)
library(psych)

# general use
library(wooldridge)
library(knitr)
library(dplyr)
library(tidyr)
```

## Question 1: CEO Salaries (1920 SEM2 Q1)
Context: Use data(‘ceosal1’). This is a data set from a 1991 issue of Business Week of CEO’s salaries in 1990.  

The data.frame has 209 observations on 12 variables: 

- `salary`: 1990 salary, thousands $ 
- `pcsalary`: percent change salary, 1989-1990 
- `sales`: 1990 firm sales, millions $ 
- `roe`: return on equity, 1988-1990 avg 
- `pcroe`: percent change roe, 1988-1990
- `ros`: return on firm’s stock, 1988-1990
- `indus`: =1 if industrial firm 
- `finance`: =1 if financial firm
- `consprod`: =1 if consumer product firm 
- `utility`: =1 if transport or utilities 
- `lsalary`: natural log of salary 
- `lsales`: natural log of sales
    
Each observation represents a CEO's salary with its respective firm characteristics. As a business analytics analyst, you are tasked to conduct the required analyses and present your findings according to the questions below. 

```{r ceo-read-dataset, echo=TRUE}
data('ceosal1') 
CS<-ceosal1
```
<p>

#### Q1.(a) Plot a histogram for `salary`. What can you deduce about the distribution of CEO salaries from this histogram? (2 mark)

```{r 1a, echo=TRUE}
salary.hist <- hist(CS$`salary`, main="Histogram of CEO Salary", xlab="Salary", ylab="No.of CEOs", col=c("lightsalmon"), xlim=c(0,20000), ylim=c(0,200), labels=TRUE) 
```

From this histogram, it does not look like a normal distribution as it does not follow a bell shape. Majority of the CEOs earn between \$0 to \$4,000 thousand range. Out of 209 CEOs, 205 CEOs earn between 0 to 4000 thousand. The distribution is right-skewed. There also seems to be 2 outliers earning between 10000 thousands to 16000 thousands from the histogram.

#### Q1.(b) In the past, the proportion of CEO with salary greater than $1 million has averaged around 0.50 (i.e. population proportion for `salary` >= 1million is 0.50). Based on the sample in this dataset, is there sufficient evidence (at 5% level of significance) to conclude that the population proportion for salary being greater than  $1million is equal to 0.5? State your hypotheses, conduct the hypotheses test and provide conclusions. (5 marks)

```{r 1b, echo=TRUE}

# 1,000,000 = 1,000 thousands

salmil <- CS %>% filter(salary>1000)
psalmil <- nrow(salmil)/nrow(CS)
z <- (psalmil - 0.50) / sqrt(0.50*(1-0.50)/nrow(CS)) # compute z-statistic for proportion
z
lcv.salmil <- qnorm(0.05) # compute lower critical value
lcv.salmil
ucv.salmil <- qnorm(0.95) # compute upper critical value
ucv.salmil
```

H0: Proportion = 0.50
H1: Proportion =/= 0.5

Since we are conducting a two-tailed test and the z value= 0.622543 (not <-1.644854 and not >1.644854), we do not have sufficient evidence to reject H0 as the z value does not fall within the rejection region. We conclude that the population proportion for salary being greater than $1million is equal to 0.5.  



#### Q1.(c) You are tasked to explore if CEO salaries vary across firm types.
(i) First, create a variable `firm` and label it as “1” if it is an industrial firm, “2” if it is a financial firm, “3” if it is a consumer product firm, and “4” if it is a transport or utilities firm. (1 mark)
(ii) Now, conduct the appropriate test(s) to assess if the mean CEO salary is significantly different across firm type. Present your hypotheses, the results and conclusions. (5 marks)

```{r 1c, echo=TRUE}
#ci
CS<- CS %>% mutate(firm = ifelse(indus == 1, "1", ifelse(finance == 1, "2", ifelse(consprod == 1, "3","4"))))
#cii
wa.out <- CS %>% welch_anova_test(salary ~ firm)
gh.out <- games_howell_test(CS, salary ~ firm)
wa.out
gh.out
```

H0: mean CEO salary is same across firms of the four different types.  
H1: at least one firm type has a different mean CEO salary from the other types of firms.

Since p-value = 0.000000566(<0.05), we have sufficient evidence to reject H0. We conclude at least one firm type has a different mean CEO salary from the other types of firms.
From Games Howell test, pairs 1:4, pairs 2:4 and 3:4 are significantly different from the rest as their p-values are <0.05. Thus, I can conclude that the mean CEO salary for transport or utilities firms has a significantly different mean CEO salary from the rest of the firms.


## Question 2: Course Selection
Here is an example of a constraints table that you can put into R Markdown: )
 
Maximize total profit using decision variables $X_1$, $X_2$ | Profit = 0.15 $X_1$ + 0.40 $X_2$
--- | --- 
Subject to |  
Budget Constraint | 0.20$X_1$ + 0.70$X_2$ $\leq$ 100
Space Constraint | $X_1$ + $X_2$ $\leq$ 200
Non-Negativity Constraint 1 | $X_1$ + $\quad$ $\geq$ 0
Non-Negativity Constraint 2 | $\quad$ + $X_2$ $\geq$ 0

 
Natalie has decided to switch her career to data science, as she feels it has more prospects than her previous industry. She is eyeing a “pico-masters” program at her local university, where she has to complete 40 units of courses to satisfy the pico-degree.
 
The program offers the following courses, in STatistics, ProGramming, and Data Management, along with their associated costs and pre-requisites. The pre-requisites for each course must be fulfilled before students are allowed to take that course. 
 
Natalie has also indicated her personal interest in each course.


Course |	Units |	Pre-requisites |	Cost |	Interest
:-- | :-- | :-- | :-- | :-- 
ST1 |	10 |	- |	$1,000 |	8
ST2 |	10 |	ST1 |	$1,500 |	4
ST3 |	10 |	ST2 |	$2,000 |	6
PG1 |	10 |	- |	$1,000 |	7
PG2a |	10 |	PG1 |	$1,500 |	5
PG2b |	10 |	PG1 |	$1,500 |	6
PG3 |	10 |	PG2a or PG2b |	$2,000 |	3
DM1 |	10 |	- 	| $1,000 | 4
DM2 |	10 |	DM1 |	$1,500 |	6
DM3 |	10 |	DM2 |	$2,000 |	7

 
#### Q2.(a) How would you write out the following constraint as a linear constraint? (1 mark)
**“Students must take ST1 before ST2”**

ST1 - ST2 >= 0


#### Q2.(b) Suppose that her only goal is to minimize cost and satisfy the requirements of the degree.
- Identify the decision variables, objective function, and the relevant constraints.
- Write them out in a table.
You may keep the “Pre-requisite” constraints in the form X + Y <= Z or X + Y >= Z or X + Y = Z for this table. 

Do not solve the problem yet.  (3 marks)

Maximize total cost using decision variables $X_1$, $X_2$, $X_3$, $X_4$, $X_5$, $X_6$, $X_7$, $X_8$, $X_9$, $X_{10}$ | Cost = 1000$X_1$ + 1500$X_2$ + 2000$X_3$ + 1000$X_4$ + 1500$X_5$ + 1500$X_6$ + 2000$X_7$ + 1000$X_8$ + 1500$X_9$ +  2000$X_{10}$
--- | --- 
Subject to |  
40 units Degree Requirements | 10$X_1$ + 10$X_2$ + 10$X_3$ + 10$X_4$ + 10$X_5$ + 10$X_6$ + 10$X_7$ + 10$X_8$ + 10$X_9$ +  10$X_{10}$ $\geq$ 40
ST2 Prerequisite | $X_1$ - $X_2$ $\geq$ 0
ST3 Prerequisite | $X_2$ - $X_3$ $\geq$ 0   
PG2a Prerequisite | $X_4$ - $X_5$ $\geq$ 0
PG2b Prerequisite | $X_4$ - $X_6$ $\geq$ 0
PG3 Prerequisite | $X_5$ + $X_6$ - $X_7$ $\leq$ 0
DM2 Prerequisite | $X_8$ - $X_9$ $\geq$ 0
DM3 Prerequisite | $X_9$ - $X_{10}$ $\geq$ 0
Binary, Integer, Non-negativity Constraints | $X_1$ to $X_{10}$ all binary, integers and $\geq$ 0


#### Q2.(c) Natalie just read a condition she missed out earlier. In order to finish the PicoMasters, she needs to finish a specialization in one of the three tracks, which is fulfilled by completing the “Level 3” version of that course. How will you specify this as a linear constraint? (2 marks)

$X_3$ + $X_7$ + $X_10$ >= 1


#### Q2.(d) Natalie admitted that “cost minimization” should be a lesser priority to “interest maximization”. Rewrite the problem to maximize her interest. Note that since cost is still a factor for her, she decides to take EXACTLY 40 units, no more than that.
- Write out the table again, including the new constraint from (c) and the changes in the preceding paragraph.
- If you are not confident of going straight from this table to R, please take the additional step of converting the linear constraints into a “fully spelled-out” constraint with all the 0s, 1s and −1s, as we did in lecture.
- Using R, write a linear program to solve Natalie’s problem.
 
Which courses should she pick? (7 marks)

Maximize interest using decision variables $X_1$, $X_2$, $X_3$, $X_4$, $X_5$, $X_6$, $X_7$, $X_8$, $X_9$, $X_{10}$ | interest = 8$X_1$ + 4$X_2$ + 6$X_3$ + 7$X_4$ + 5$X_5$ + 6$X_6$ + 3$X_7$ + 4$X_8$ + 6$X_9$ +  7$X_{10}$
--- | --- 
Subject to |  
40 units Degree Requirements | 10$X_1$ + 10$X_2$ + 10$X_3$ + 10$X_4$ + 10$X_5$ + 10$X_6$ + 10$X_7$ + 10$X_8$ + 10$X_9$ +  10$X_{10}$ $\geq$ 40
ST2 Prerequisite | $X_1$ - $X_2$ $\geq$ 0
ST3 Prerequisite | $X_2$ - $X_3$ $\geq$ 0   
PG2a Prerequisite | $X_4$ - $X_5$ $\geq$ 0
PG2b Prerequisite | $X_4$ - $X_6$ $\geq$ 0
PG3 Prerequisite | $X_5$ + $X_6$ - $X_7$ $\leq$ 0
DM2 Prerequisite | $X_8$ - $X_9$ $\geq$ 0
DM3 Prerequisite | $X_9$ - $X_{10}$ $\geq$ 0
Specialization requisite | $X_3$ + $X_7$ + $X_10$ $\geq$ 1
Binary, Integer, Non-negativity Constraints | $X_1$ to $X_{10}$ all binary, integers and $\geq$ 0

```{r 2d, echo=TRUE}
objective.fn <- c(8,4,6,7,5,6,3,4,6,7)
const.mat <- matrix(c(rep(10,10),
                      1,-1,0,0,0,0,0,0,0,0,
                      0,1,-1,0,0,0,0,0,0,0,
                      0,0,0,1,-1,0,0,0,0,0,
                      0,0,0,1,0,-1,0,0,0,0,
                      0,0,0,0,1,1,-1,0,0,0,
                      0,0,0,0,0,0,0,1,-1,0,
                      0,0,0,0,0,0,0,0,1,-1,
                      0,0,1,0,0,0,1,0,0,1),
                      ncol = 10,byrow = T)
const.dir <- c('=',rep('>=',8))
const.rhs <- c(40,rep(0,7),1)
lp.solution <- lp('max',objective.fn,const.mat,const.dir,const.rhs, binary.vec = c(1:10))
lp.solution$solution
```

Based on the results, Natalie should take ST1,ST2,ST3 and PG1 to maximise her interest.


